{% extends 'base.html' %}

{% block title %}همکاری با وینور اکسپرس | VINOR EXPRESS{% endblock %}

{% block head %}
  <meta name="description" content="همکاری با وینور اکسپرس در زمینه ملک - فرصت همکاری برای مشاوران املاک" />
  <meta name="theme-color" content="#2563EB">
  <link rel="canonical" href="{{ request.url_root.rstrip('/') }}">

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="همکاری با وینور اکسپرس | VINOR EXPRESS">
  <meta property="og:description" content="همکاری با وینور اکسپرس در زمینه ملک - فرصت همکاری برای مشاوران املاک">
  <meta property="og:url" content="{{ request.url }}">

  <style>
    .focusable:focus{outline:2px solid #2563EB;outline-offset:2px}
    /* Hide slide-out menu and its toggles on landing */
    #menuToggle, #menuBackdrop, #menuOverlay, #sideMenu { display: none !important; }
  </style>
{% endblock %}

{% block content %}
  {# Header مینیمال #}
  <header class="fixed top-0 left-0 right-0 z-50 bg-white/70 dark:bg-gray-950/70 backdrop-blur border-b border-transparent">
    <div class="max-w-6xl mx-auto px-4 h-14 flex items-center justify-between">
      <a href="{{ url_for('main.index') }}" class="flex items-center gap-2" aria-label="وینور">
        <span class="text-lg font-extrabold text-gray-900 dark:text-white">وینور اکسپرس</span>
      </a>
      <nav class="flex items-center gap-2">
        <a href="{{ url_for('express_partner.login') }}"
           class="flex items-center gap-1 text-xs font-medium text-white px-3 py-1.5 rounded-full bg-gray-900 dark:bg-white dark:text-gray-900 hover:opacity-90 transition">
          <i class="fa-solid fa-user text-[11px]"></i>
          <span>ورود</span>
        </a>
      </nav>
    </div>
  </header>

  {# محتوای اصلی لندینگ #}
  <div class="max-w-6xl mx-auto pt-16 px-4 pb-20 space-y-10">

    <!-- Hero مینیمال -->
    <section class="relative overflow-hidden rounded-2xl border border-gray-200 dark:border-gray-800 bg-gradient-to-b from-white to-gray-50 dark:from-gray-900 dark:to-gray-950">
      <div class="absolute inset-0 pointer-events-none" aria-hidden="true"></div>
      <div class="relative px-5 sm:px-8 py-10 sm:py-14">
        <div class="max-w-2xl">
          <h1 class="text-2xl sm:text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white">
            وینور اکسپرس — مینیمال، سریع، شفاف
          </h1>
          <p class="mt-2 text-sm sm:text-base text-gray-600 dark:text-gray-400 leading-relaxed">
            جایی برای معرفی و همکاری روی فایل‌های ملکی تأییدشده؛ با تمرکز روی تجربه کاربری ساده و کم‌اصطکاک.
          </p>
        </div>
        <div class="mt-5 flex flex-wrap items-center gap-2">
          <a href="{{ url_for('express_partner.apply') }}"
             class="inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 text-sm font-medium">
            <i class="fa-solid fa-star text-xs"></i>
            درخواست همکاری
          </a>
          {% if android_apk_url %}
          <a href="{{ android_apk_url }}" download rel="noopener"
             class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-green-600 hover:bg-green-700 text-white text-sm font-medium">
            <i class="fa-solid fa-download text-xs"></i>
            دانلود اندروید ({{ android_apk_version or '—' }})
          </a>
          {% endif %}
          <div id="expressPartnerInstallLanding" class="hidden">
            <button id="expressPartnerInstallLandingBtn"
                    class="inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 text-sm font-medium">
              <i class="fa-solid fa-download text-xs"></i>
              نصب PWA
            </button>
          </div>
        </div>
        <div class="mt-3 flex flex-wrap items-center gap-2">
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-[11px] text-gray-700 dark:text-gray-300">
            <i class="fa-solid fa-bolt"></i> سریع و سبک
          </span>
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-[11px] text-gray-700 dark:text-gray-300">
            <i class="fa-solid fa-shield-halved"></i> شفاف و امن
          </span>
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-[11px] text-gray-700 dark:text-gray-300">
            <i class="fa-solid fa-mobile-screen"></i> نصب به‌صورت PWA
          </span>
        </div>
      </div>
    </section>



    <!-- Features - سبک دیوار -->
    <section class="grid sm:grid-cols-3 gap-3">
      <div class="bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-lg bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 grid place-items-center">
            <i class="fa-solid fa-list-check"></i>
          </div>
          <div>
            <div class="text-sm font-bold text-gray-900 dark:text-white">فایل‌های تأییدشده</div>
            <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">مشاهده و همکاری روی فایل‌هایی که بررسی اولیه شده‌اند.</p>
          </div>
        </div>
      </div>
      <div class="bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-lg bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 grid place-items-center">
            <i class="fa-solid fa-money-bill-trend-up"></i>
          </div>
          <div>
            <div class="text-sm font-bold text-gray-900 dark:text-white">پورسانت شفاف</div>
            <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">ثبت و پیگیری پورسانت‌ها به‌صورت درون‌برنامه‌ای.</p>
          </div>
        </div>
      </div>
      <div class="bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-lg bg-purple-50 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 grid place-items-center">
            <i class="fa-solid fa-bolt"></i>
          </div>
          <div>
            <div class="text-sm font-bold text-gray-900 dark:text-white">تجربه سریع</div>
            <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">رابط کاربری سبک و مینیمال برای کار روزمره.</p>
          </div>
        </div>
      </div>
    </section>





    <!-- About (Compact) - Divar Style -->
    <div class="bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4">
      <div class="flex items-start gap-3">
        <div class="w-10 h-10 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center flex-shrink-0">
          <i class="fa-solid fa-handshake text-gray-600 dark:text-gray-400"></i>
        </div>
        <p class="text-sm text-gray-700 dark:text-gray-300 leading-relaxed">
          وینور اکسپرس با استانداردهای تجربه‌کاربری مدرن، فرآیند معرفی و معامله ملک را ساده می‌کند.
          اگر فعال حوزه املاک هستید، با «همکاری اکسپرس» فایل‌های تأییدشده دریافت می‌کنید و
          پس از فروش، کمیسیون شفاف و قابل‌پیگیری دریافت می‌کنید.
        </p>
      </div>
    </div>







  </div>

  {# Spacer removed: no bottom nav on landing #}
{% endblock %}

{% block footer %}{% endblock %}

{% block scripts %}
  <script>
    // --- Dark Mode ---
    const root = document.documentElement;
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') root.classList.remove('dark');
    document.getElementById('darkToggle')?.addEventListener('click', () => {
      root.classList.toggle('dark');
      localStorage.setItem('theme', root.classList.contains('dark') ? 'dark' : 'light');
      const icon = document.querySelector('#darkToggle i');
      if (icon) {
        icon.className = root.classList.contains('dark') ? 'fa-solid fa-sun' : 'fa-solid fa-moon';
      }
    });

    // Disable slide-out menu behavior on landing (mobile)
    try { localStorage.setItem('vinor_show_sidebar','0'); } catch(_){}
    // Prevent swipe-to-open listeners from base on this page
    ['touchstart','touchmove','touchend','pointerdown','pointermove','pointerup'].forEach(evt => {
      window.addEventListener(evt, function(e){ e.stopImmediatePropagation(); }, true);
    });
    // Update icon on load
    if (savedTheme === 'light') {
      const icon = document.querySelector('#darkToggle i');
      if (icon) icon.className = 'fa-solid fa-sun';
    }

    // --- Express Partner PWA Install Hooks ---
    let expressPartnerDeferredPrompt;

    // Detect mobile platform
    function detectMobilePlatform() {
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
        return 'ios';
      }
      if (/android/i.test(userAgent)) {
        return 'android';
      }
      return 'other';
    }

    // Show mobile install instructions
    function showMobileInstallInstructions() {
      const platform = detectMobilePlatform();
      const instructionsDiv = document.getElementById('mobileInstallInstructions');
      const iosInstructions = document.getElementById('iosInstructions');
      const androidInstructions = document.getElementById('androidInstructions');
      
      if (instructionsDiv) {
        instructionsDiv.classList.remove('hidden');
        if (platform === 'ios' && iosInstructions) {
          iosInstructions.classList.remove('hidden');
        } else if (platform === 'android' && androidInstructions) {
          androidInstructions.classList.remove('hidden');
        }
      }
    }

    // Handle PWA install prompt for Express Partner
    window.addEventListener('beforeinstallprompt', (e) => {
      const url = new URL(window.location.href);
      if (['/', '/partners'].includes(url.pathname) || url.pathname.startsWith('/express/partner/')) {
        e.preventDefault();
        expressPartnerDeferredPrompt = e;

        // Show install buttons when PWA is available
        const installBtnContainer = document.getElementById('expressPartnerInstallLanding');
        const installHeroContainer = document.getElementById('expressPartnerInstallHero');
        if (installBtnContainer) {
          installBtnContainer.classList.remove('hidden');
        }
        if (installHeroContainer) {
          installHeroContainer.classList.remove('hidden');
        }
      }
    });

    // Show mobile install instructions on mobile devices if PWA install is not available
    document.addEventListener('DOMContentLoaded', function() {
      const platform = detectMobilePlatform();
      const installHeroContainer = document.getElementById('expressPartnerInstallHero');
      
      // If on mobile and no install prompt available, show instructions after a delay
      if ((platform === 'ios' || platform === 'android') && !expressPartnerDeferredPrompt) {
        setTimeout(() => {
          if (installHeroContainer && installHeroContainer.classList.contains('hidden')) {
            // Show install card with mobile instructions
            installHeroContainer.classList.remove('hidden');
            showMobileInstallInstructions();
            // Hide the install button and show instructions directly
            const installBtn = document.getElementById('expressPartnerInstallHeroBtn');
            if (installBtn) {
              installBtn.style.display = 'none';
            }
          }
        }, 1000);
      }
    });

    // Handle successful installation
    window.addEventListener('appinstalled', (evt) => {
      console.log('Express Partner PWA was installed successfully');
      expressPartnerDeferredPrompt = null;

      // Update install buttons after successful install
      const installBtn = document.getElementById('expressPartnerInstallLandingBtn');
      const installHeroBtn = document.getElementById('expressPartnerInstallHeroBtn');
      if (installBtn) {
        installBtn.innerHTML = '<i class="fa-solid fa-check text-sm"></i> <span>نصب شد</span>';
        installBtn.disabled = true;
        installBtn.classList.add('opacity-50', 'cursor-not-allowed');
      }
      if (installHeroBtn) {
        installHeroBtn.innerHTML = '<i class="fa-solid fa-check text-sm"></i> <span>نصب شد</span>';
        installHeroBtn.disabled = true;
        installHeroBtn.classList.add('opacity-50', 'cursor-not-allowed');
      }
    });

    // PWA Install Button Handler
    function handleInstall() {
      if (expressPartnerDeferredPrompt) {
        expressPartnerDeferredPrompt.prompt();
        expressPartnerDeferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted Express Partner PWA install');
          } else {
            console.log('User dismissed Express Partner PWA install');
          }
          expressPartnerDeferredPrompt = null;
        }).catch((error) => {
          console.error('Error during Express Partner PWA install:', error);
        });
      } else {
        // Fallback: show mobile instructions for mobile devices
        const platform = detectMobilePlatform();
        if (platform === 'ios' || platform === 'android') {
          showMobileInstallInstructions();
        } else {
          // Show generic hint for desktop
          const heroHint = document.getElementById('expressPartnerInstallHint');
          if (heroHint) {
            heroHint.classList.remove('hidden');
          }
        }
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      const installBtn = document.getElementById('expressPartnerInstallLandingBtn');
      const installHeroBtn = document.getElementById('expressPartnerInstallHeroBtn');
      const installHint = document.getElementById('expressPartnerInstallHint');
      
      if (installBtn) {
        installBtn.addEventListener('click', async function(e) {
          e.preventDefault();
          handleInstall();
          if (installHint) installHint.classList.remove('hidden');
        });
      }
      
      if (installHeroBtn) {
        installHeroBtn.addEventListener('click', async function(e) {
          e.preventDefault();
          handleInstall();
          if (installHint) installHint.classList.remove('hidden');
        });
      }
    });
  </script>
{% endblock %}
