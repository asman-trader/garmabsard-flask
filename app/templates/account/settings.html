{% extends 'base.html' %}
{% set hide_header = True %}

{% block title %}تنظیمات | وینور{% endblock %}

{% block content %}
<!-- ظرف اصلی (Mobile-First) -->
<div class="mx-auto max-w-xl px-4 pb-28 pt-3 sm:pt-6">

  <!-- Header: back + title + icon (like favorites) -->
  <header class="fixed top-0 inset-x-0 z-30 bg-white dark:bg-gray-800 border-b dark:border-gray-700">
    <div class="max-w-xl mx-auto px-3 sm:px-4 py-3 flex items-center justify-between">
      <button type="button" onclick="history.back()" class="w-9 h-9 grid place-items-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-700" aria-label="بازگشت">
        <i class="fas fa-arrow-right"></i>
      </button>
      <h1 class="text-base sm:text-lg font-bold text-gray-900 dark:text-white">تنظیمات</h1>
      <button type="button" class="w-9 h-9 grid place-items-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-700" aria-label="تنظیمات">
        <i class="fas fa-gear"></i>
      </button>
    </div>
  </header>
  <div class="h-20"></div>

  <!-- نمایش جستجوی سریع -->
  <section class="rounded-2xl border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-800 shadow-sm overflow-hidden">
    <div class="px-4 pt-4 pb-2 text-xs font-bold text-gray-500 dark:text-gray-400">جستجو</div>
    <div class="px-4 pb-4 flex items-center justify-between gap-3">
      <div>
        <div class="text-sm font-semibold">نمایش جستجوی سریع در خانه</div>
        <div class="text-xs text-gray-500 dark:text-gray-400">نوار جستجوی سریع در صفحه اصلی</div>
      </div>
      <label class="inline-flex items-center cursor-pointer">
        <input id="toggleQuickSearch" type="checkbox" class="sr-only">
        <span class="w-10 h-6 bg-gray-300 dark:bg-gray-700 rounded-full relative">
          <span class="dot absolute top-1 right-1 w-4 h-4 bg-white rounded-full transition"></span>
        </span>
      </label>
    </div>
  </section>

  <!-- نمایش منوی کناری (سایدبار) -->
  <section class="mt-4 rounded-2xl border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-800 shadow-sm overflow-hidden">
    <div class="px-4 pt-4 pb-2 text-xs font-bold text-gray-500 dark:text-gray-400">ناوبری</div>
    <div class="px-4 pb-4 flex items-center justify-between gap-3">
      <div>
        <div class="text-sm font-semibold">نمایش منوی کناری</div>
        <div class="text-xs text-gray-500 dark:text-gray-400">دکمه سه‌خط و پنل سایدبار قابل نمایش/پنهان</div>
      </div>
      <label class="inline-flex items-center cursor-pointer">
        <input id="toggleSidebar" type="checkbox" class="sr-only">
        <span class="w-10 h-6 bg-gray-300 dark:bg-gray-700 rounded-full relative">
          <span class="dot absolute top-1 right-1 w-4 h-4 bg-white rounded-full transition"></span>
        </span>
      </label>
    </div>
  </section>
</div>

<!-- JS: تنظیم جستجوی سریع -->
<script>
  (function(){
    const quick = document.getElementById('toggleQuickSearch');
    try {
      const qs = localStorage.getItem('vinor_show_quick_search');
      const on = qs ? qs==='1' : true; // پیش‌فرض: نمایش فعال باشد
      if (quick){ quick.checked = !!on; moveDotQS(); }
    } catch {}

    function moveDotQS(){
      const dot = document.querySelector('#toggleQuickSearch + span .dot');
      if (!dot || !quick) return;
      dot.style.right = quick.checked ? '1.5rem' : '0.25rem';
    }

    quick?.addEventListener('change', ()=>{
      try{ localStorage.setItem('vinor_show_quick_search', quick.checked ? '1' : '0'); }catch{}
      moveDotQS();
      // اطلاع به صفحه اصلی برای پنهان/نمایش
      try{ window.dispatchEvent(new CustomEvent('vinor:qs-toggle', { detail: quick.checked })); }catch{}
    });
  })();
</script>

<!-- JS: تنظیم سایدبار کاربر -->
<script>
  (function(){
    const el = document.getElementById('toggleSidebar');
    try {
      const v = localStorage.getItem('vinor_show_sidebar');
      const on = v ? v==='1' : true; // پیش‌فرض: نمایش فعال
      if (el){ el.checked = !!on; moveDotSB(); }
    } catch {}

    function moveDotSB(){
      const dot = document.querySelector('#toggleSidebar + span .dot');
      if (!dot || !el) return;
      dot.style.right = el.checked ? '1.5rem' : '0.25rem';
    }

    el?.addEventListener('change', ()=>{
      try{ localStorage.setItem('vinor_show_sidebar', el.checked ? '1' : '0'); }catch{}
      moveDotSB();
      // اطلاع به صفحات برای اعمال فوری (اختیاری)
      try{ window.dispatchEvent(new CustomEvent('vinor:sidebar-toggle', { detail: el.checked })); }catch{}
    });
  })();
</script>
{% endblock %}
