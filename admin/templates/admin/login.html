<!DOCTYPE html>
<html lang="fa" dir="rtl" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>ورود ادمین | وینور</title>
  <meta name="description" content="ورود به پنل مدیریت وینور" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="{{ url_for('static', filename='vendor/fontawesome/css/all.min.css') }}" onerror="this.parentNode.removeChild(this)">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;800;900&display=swap" rel="stylesheet" />

  <style>
    html, body {
      font-family: 'Vazirmatn', sans-serif;
    }
    .focusable:focus {
      outline: 2px solid #0ea5e9;
      outline-offset: 2px;
    }
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
      animation: fade-in 0.3s ease-out;
    }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-950 min-h-screen flex items-center justify-center p-4">

  <div class="w-full max-w-md">
    <!-- Login Form - Divar Style -->
    <form method="POST" action="{{ url_for('admin.login') }}" 
          class="bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4">
      
      <!-- CSRF Token -->
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <!-- Header - Divar Style -->
      <div class="text-center space-y-2">
        <h1 class="text-xl font-semibold text-gray-900 dark:text-white">پنل مدیریت</h1>
        <p class="text-sm text-gray-500 dark:text-gray-400">ورود به سیستم مدیریتی</p>
      </div>

      <!-- Messages - Divar Style -->
      {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
          <div class="space-y-2">
            {% for category, msg in messages %}
              <div class="rounded-lg px-4 py-3 border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 flex items-start gap-2
                          {% if category in ['success', 'ok'] %}
                            text-green-700 dark:text-green-400
                          {% elif category in ['warning'] %}
                            text-amber-700 dark:text-amber-400
                          {% elif category in ['info'] %}
                            text-blue-700 dark:text-blue-400
                          {% else %}
                            text-red-700 dark:text-red-400
                          {% endif %}">
                <i class="fa-solid mt-0.5 flex-shrink-0
                          {% if category in ['success', 'ok'] %}fa-check-circle
                          {% elif category in ['warning'] %}fa-exclamation-triangle
                          {% elif category in ['info'] %}fa-info-circle
                          {% else %}fa-times-circle{% endif %}"></i>
                <span class="flex-1 text-sm">{{ msg }}</span>
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <!-- Username -->
      <div>
        <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">نام کاربری</label>
        <input name="username" type="text" autocomplete="username" dir="ltr"
               placeholder="نام کاربری"
               class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 
                      bg-white dark:bg-gray-800 text-gray-900 dark:text-white
                      placeholder:text-gray-400 dark:placeholder:text-gray-400
                      focus:ring-2 focus:ring-blue-500 focus:border-transparent focusable"
               required>
      </div>

      <!-- Password -->
      <div>
        <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">رمز عبور</label>
        <input name="password" type="password" autocomplete="current-password"
               placeholder="رمز عبور"
               class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 
                      bg-white dark:bg-gray-800 text-gray-900 dark:text-white
                      placeholder:text-gray-400 dark:placeholder:text-gray-400
                      focus:ring-2 focus:ring-blue-500 focus:border-transparent focusable"
               required>
      </div>

      <!-- Submit Button -->
      <button type="submit"
              class="w-full px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors focusable">
        ورود
      </button>

      <!-- Help Info -->
      <div class="text-center pt-2">
        <p class="text-xs text-gray-500 dark:text-gray-400">
          بعد از ورود، به صفحه انتخاب پنل هدایت می‌شوید
        </p>
        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">
          برای دسترسی به پنل همکاران: وینور اکسپرس → همکاران
        </p>
      </div>

      <!-- Dark Mode Toggle -->
      <div class="text-center pt-4 border-t border-gray-200 dark:border-gray-800">
        <button type="button" id="darkToggle" 
                class="text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors focusable"
                aria-label="تغییر تم">
          <i class="fa-solid fa-moon"></i>
        </button>
      </div>
    </form>
  </div>

  <script>
    // Dark Mode
    const root = document.documentElement;
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') root.classList.remove('dark');

    document.getElementById('darkToggle')?.addEventListener('click', () => {
      root.classList.toggle('dark');
      localStorage.setItem('theme', root.classList.contains('dark') ? 'dark' : 'light');
      
      const icon = document.querySelector('#darkToggle i');
      if (icon) {
        icon.className = root.classList.contains('dark') ? 'fa-solid fa-sun' : 'fa-solid fa-moon';
      }
    });

    // Update icon on load
    if (savedTheme === 'light') {
      const icon = document.querySelector('#darkToggle i');
      if (icon) icon.className = 'fa-solid fa-sun';
    }
  </script>
</body>
</html>
