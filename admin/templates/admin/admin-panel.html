<!DOCTYPE html>
<html lang="fa" dir="rtl" x-data="{ darkMode: false, sidebarOpen: true }" :class="{ 'dark': darkMode }"
      x-init="darkMode = localStorage.getItem('darkMode') === 'true'">
<head>
  <meta charset="UTF-8" />
  <title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª | ÙˆÛŒÙ†ÙˆØ± (Vinor)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['iranyekan', 'ui-sans-serif', 'system-ui'] },
          colors: { vinor: { 600: '#0ea5e9', 700: '#0284c7' } }
        }
      }
    }
  </script>
  <link rel="preload" as="font" type="font/woff2" crossorigin
        href="{{ url_for('static', filename='fonts/iranyekan.woff2') }}">
  <link rel="preload" as="font" href="{{ url_for('static', filename='vendor/fontawesome/webfonts/fa-solid-900.woff2') }}" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="{{ url_for('static', filename='vendor/fontawesome/webfonts/fa-regular-400.woff2') }}" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="{{ url_for('static', filename='vendor/fontawesome/webfonts/fa-brands-400.woff2') }}" type="font/woff2" crossorigin>
  <link rel="stylesheet" href="{{ url_for('static', filename='vendor/fontawesome/css/all.min.css') }}">
  <style>
    @font-face {
      font-family: 'iranyekan';
      src: url('{{ url_for('static', filename='fonts/iranyekan.woff2') }}') format('woff2');
      font-weight: 100 900; font-style: normal; font-display: swap;
    }
    body { font-family: 'iranyekan', ui-sans-serif, system-ui; }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-100 min-h-screen flex">

  <!-- Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± -->
  <aside class="w-64 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 h-screen p-4 fixed right-0 top-0 hidden lg:block">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-lg font-bold text-vinor-700 dark:text-vinor-600">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆÛŒÙ†ÙˆØ±</h2>
      <button class="text-gray-500 hover:text-yellow-400" @click="darkMode = !darkMode; localStorage.setItem('darkMode', darkMode)" aria-label="ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª ØªÛŒØ±Ù‡">
        <svg x-show="!darkMode" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
             viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75"
             d="M12 3v2m0 14v2m7-9h2M3 12H1m15.364-6.364l1.414 1.414M4.222 19.778l1.414-1.414m0-12.728L4.222 4.222M18.778 19.778l-1.414-1.414M12 8a4 4 0 100 8 4 4 0 000-8z"/></svg>
        <svg x-show="darkMode" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24"
             fill="currentColor"><path d="M21.64 13.01A9 9 0 1111 2.36a7 7 0 0010.64 10.65z"/></svg>
      </button>
    </div>
    <nav class="flex flex-col gap-2 text-sm">
      <a href="{{ url_for('admin.pending_lands') }}" class="px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700">ğŸ“‹ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</a>
      <a href="{{ url_for('admin.approved_lands') }}" class="px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700">âœ… Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ£ÛŒÛŒØ¯ Ø´Ø¯Ù‡</a>
      <a href="{{ url_for('admin.rejected_lands') }}" class="px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700">â›” Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±Ø¯ Ø´Ø¯Ù‡</a>
      <a href="{{ url_for('admin.add_land') }}" class="px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700">â• Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ú¯Ù‡ÛŒ</a>
      <a href="{{ url_for('admin.settings') }}" class="px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700">âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</a>
      <form method="post" action="{{ url_for('admin.logout') }}" class="mt-2">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="w-full text-left px-3 py-2 rounded text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20">ğŸšª Ø®Ø±ÙˆØ¬</button>
      </form>
    </nav>
  </aside>

  <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
  <main class="flex-1 w-full lg:mr-64 p-4 sm:p-6">
    <!-- Ù‡Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ -->
    <div class="lg:hidden mb-4 flex items-center justify-between">
      <h1 class="text-lg font-bold text-vinor-700 dark:text-vinor-600">Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§</h1>
      <div class="flex items-center gap-3">
        <a href="{{ url_for('admin.add_land') }}" class="px-3 py-1.5 rounded bg-vinor-600 text-white text-sm">Ø§ÙØ²ÙˆØ¯Ù†</a>
        <button class="text-gray-500 hover:text-yellow-400" @click="darkMode = !darkMode; localStorage.setItem('darkMode', darkMode)" aria-label="ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª ØªÛŒØ±Ù‡">
          <svg x-show="!darkMode" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
               viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75"
               d="M12 3v2m0 14v2m7-9h2M3 12H1m15.364-6.364l1.414 1.414M4.222 19.778l1.414-1.414m0-12.728L4.222 4.222M18.778 19.778l-1.414-1.414M12 8a4 4 0 100 8 4 4 0 000-8z"/></svg>
          <svg x-show="darkMode" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24"
               fill="currentColor"><path d="M21.64 13.01A9 9 0 1111 2.36a7 7 0 0010.64 10.65z"/></svg>
        </button>
      </div>
    </div>

    <!-- Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡ -->
    <h1 class="hidden lg:block text-2xl font-bold mb-6 text-vinor-700 dark:text-vinor-600">Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§</h1>

    <!-- Ù„ÛŒØ³Øª Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ (Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§) -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-10">
      {% for land in lands %}
      <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl shadow p-4 flex flex-col">
        {% set cover = (land.images[0] if land.images and land.images|length > 0 else None) %}
        {% if cover %}
          <img src="{{ cover if ('://' in cover) else (('/uploads/' + cover) if not cover.startswith('/uploads/') else cover) }}"
               class="w-full h-40 object-cover rounded-xl mb-3" alt="Ø¹Ú©Ø³ Ø¢Ú¯Ù‡ÛŒ">
        {% endif %}
        <h3 class="font-semibold text-base sm:text-lg text-gray-800 dark:text-gray-100">{{ land.title or 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†' }}</h3>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">{{ land.size }} Ù…ØªØ± â€¢ {{ land.location }}</p>
        <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">Ú©Ø¯: {{ land.code }}</p>

        <div class="mt-4 flex items-center justify-between gap-2">
          <!-- Ø­Ø°Ù (POST + CSRF) -->
          <form method="post" action="{{ url_for('admin.delete_land', land_id=loop.index0) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit"
                    class="px-3 py-1.5 rounded-lg text-white bg-rose-600 hover:bg-rose-700 text-sm">
              ğŸ—‘ Ø­Ø°Ù
            </button>
          </form>

          <!-- ÙˆÛŒØ±Ø§ÛŒØ´ -->
          <a href="{{ url_for('admin.edit_land', land_id=loop.index0) }}"
             class="px-3 py-1.5 rounded-lg text-white bg-vinor-600 hover:bg-vinor-700 text-sm">
            âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´
          </a>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- ÙØ±Ù… Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ú¯Ù‡ÛŒ (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ Ùˆ Ø§Ø² ØµÙØ­Ù‡ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯) -->
    <section id="uploadForm" class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 p-4 sm:p-6 rounded-2xl shadow">
      <h2 class="text-lg sm:text-xl font-bold mb-4 text-vinor-700 dark:text-vinor-600">Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ú¯Ù‡ÛŒ Ø¬Ø¯ÛŒØ¯</h2>
      <form action="{{ url_for('admin.add_land') }}" method="post" enctype="multipart/form-data" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="text" name="title" placeholder="Ø¹Ù†ÙˆØ§Ù†" class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600" required>
        <input type="text" name="size" placeholder="Ù…ØªØ±Ø§Ú˜ (Ù…Ø«Ù„Ø§Ù‹ 500)" class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600" required>
        <input type="text" name="location" placeholder="Ù…ÙˆÙ‚Ø¹ÛŒØª (Ù…Ø«Ù„Ø§Ù‹ Ø¯Ø´Øª Ø§ÙˆÙ„)" class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600" required>

        <!-- Ú©Ø¯ Ø¢Ú¯Ù‡ÛŒ Ø¯Ø± Ø¨Ú©â€ŒØ§Ù†Ø¯ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯Ø› Ø§ÛŒÙ† ÙÛŒÙ„Ø¯ Ø±Ø§ Ø­Ø°Ù Ú©Ø±Ø¯ÛŒÙ… -->
        <div class="sm:col-span-2">
          <label class="block text-sm text-gray-600 dark:text-gray-300 mb-1">Ø¹Ú©Ø³â€ŒÙ‡Ø§ (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ú†Ù†Ø¯ Ù…ÙˆØ±Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯)</label>
          <input type="file" name="images" multiple class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600">
        </div>

        <textarea name="description" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª"
                  class="sm:col-span-2 w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600" rows="3"></textarea>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:col-span-2">
          <input type="text" name="category" placeholder="Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ (Ø²Ù…ÛŒÙ†/Ø¨Ø§Øº/ÙˆÛŒÙ„Ø§/Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù†)" class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600">
          <input type="text" name="document_type" placeholder="Ù†ÙˆØ¹ Ø³Ù†Ø¯ (Ù…Ø«Ù„Ø§Ù‹ ØªÚ©â€ŒØ¨Ø±Ú¯)" class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600">
          <input type="text" name="price_total" placeholder="Ù‚ÛŒÙ…Øª Ú©Ù„ (ØªÙˆÙ…Ø§Ù†)" class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600">
          <input type="text" name="price_per_meter" placeholder="Ù‚ÛŒÙ…Øª Ù‡Ø± Ù…ØªØ± (ØªÙˆÙ…Ø§Ù†)" class="w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-600">
        </div>

        <div class="sm:col-span-2 flex justify-end">
          <button type="submit" class="px-4 py-2 rounded-lg bg-vinor-600 hover:bg-vinor-700 text-white font-semibold">
            Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ
          </button>
        </div>
      </form>
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">Ø¯Ø± ÙˆÛŒÙ†ÙˆØ±ØŒ Ú©Ø¯ Ø¢Ú¯Ù‡ÛŒ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ùˆ ÛŒÚ©ØªØ§ ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>
    </section>
  </main>

  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</body>
</html>
